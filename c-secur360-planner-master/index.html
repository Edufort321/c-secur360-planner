<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificateur de Projet - C-Secur360 V6.7</title>

    <!-- PWA Configuration -->
    <meta name="theme-color" content="#2563eb">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Planificateur C-Secur360 V6.7">
    <link rel="manifest" href="/manifest.json">

    <!-- Favicon -->
    <link rel="icon" id="favicon" type="image/x-icon">

    <!-- Google Drive API Scripts -->
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>

    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Génération du favicon dynamique -->
    <script>
        function createFavicon() {
            const canvas = document.createElement('canvas');
            canvas.width = 32;
            canvas.height = 32;
            const ctx = canvas.getContext('2d');

            // Fond bleu C-Secur360
            ctx.fillStyle = '#2563eb';
            ctx.fillRect(0, 0, 32, 32);

            // Texte CS en blanc
            ctx.fillStyle = 'white';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('CS', 16, 20);

            // Convertir en favicon
            const favicon = document.getElementById('favicon');
            favicon.href = canvas.toDataURL('image/x-icon');
        }

        // Diagnostic Vercel - Logger les infos système
        function logVercelDiagnostics() {
            console.group('🔍 VERCEL DIAGNOSTICS');
            console.log('📍 Location:', window.location.href);
            console.log('🌐 Host:', window.location.host);
            console.log('📂 Pathname:', window.location.pathname);
            console.log('🔗 Origin:', window.location.origin);
            console.log('📦 Root element:', document.getElementById('root'));
            console.log('📜 Scripts:', Array.from(document.scripts).map(s => s.src || s.textContent.substring(0, 50)));
            console.log('⚙️ User Agent:', navigator.userAgent);
            console.log('🕐 Timestamp:', new Date().toISOString());
            console.groupEnd();

            // Vérifier si le script principal se charge
            const mainScript = document.querySelector('script[src*="index.js"]');
            if (mainScript) {
                mainScript.addEventListener('error', (e) => {
                    console.error('❌ ERREUR CHARGEMENT SCRIPT PRINCIPAL:', e);
                    console.error('Script src:', mainScript.src);
                });
                mainScript.addEventListener('load', () => {
                    console.log('✅ Script principal chargé avec succès');
                });
            }

            // Logger les erreurs réseau
            window.addEventListener('error', (e) => {
                if (e.target.tagName === 'SCRIPT' || e.target.tagName === 'LINK') {
                    console.error('❌ ERREUR CHARGEMENT RESSOURCE:', {
                        tag: e.target.tagName,
                        src: e.target.src || e.target.href,
                        error: e.message
                    });
                }
            }, true);
        }

        // Générer le favicon dès que possible
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                createFavicon();
                logVercelDiagnostics();
            });
        } else {
            createFavicon();
            logVercelDiagnostics();
        }
    </script>
</head>
<body>
    <div id="root"></div>
    <script type="module" src="/src/index.js"></script>
</body>
</html>